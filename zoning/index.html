<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <title>Bourbon County Zoning Atlas</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    
<!--    <script src="https://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

<!--    <link rel="stylesheet" href="https://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />    -->
<!--
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
-->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
  integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
  crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
  integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
  crossorigin=""></script>

    <style>
        body {
            margin: 0;
            padding: 0;
        }
        #map {
            position: absolute;
            width: 100%;
            top: 0;
            bottom: 0;
        }
        #hover-window {
            background: whitesmoke;
            box-shadow: 0 1px 5px rgba(0,0,0,.65);
            padding: 6px 8px;
            border-radius: 4px;
            min-height: 40px;
            min-width: 60px;
            text-align: left;
            position: absolute;
            z-index: 10;
            display: none;
        }
/*
        h1 {
            font-family: 'Rock Salt', cursive;
            font-size: 1.5em;
            padding: 0;
        }
        p {
            font-family: 'Lato', sans-serif;
            font-size: 1em;
        }
        p2 {
            font-family: 'Nothing You Could Do', cursive;
            font-size: 1.5em;
            line-height: 75%;
            margin: 0px;
        }
        .leaflet-popup-content p {
            margin: 0px 0;
        }
        .leaflet-popup-content-wrapper {
            background: rgba(75,75,75,0.8);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            color: whitesmoke;
            font-size: 1.2em;
        }
        .leaflet-popup-tip {
            background: rgba(75,75,75,0.8);
        }  
*/
     
        
    </style>
    
</head>

<body>
    <div id='hover-window'></div>
    <div id='map'></div>
    
    <script src ="Flood_100yr.js"></script>
    <script src ="Flood_Zoning_Union.js"></script>
    <script src ="Zoning_2014.js"></script>
    
    <script>

        var map;
        var targetDiv = 'map';
        
        var options = {
            center: [38.2171,-84.2279],
            zoom: 12,
            maxZoom: 18,
            minZoom: 5,
            attributionControl: false,
        }        
        
        map = L.map(targetDiv, options);
    
//      set bounds based on zoom level 5 (for buffer room)
//        var southWest = L.latLng(26.076, -111.665),
//            northEast = L.latLng(48.835, -51.635),
//            bounds = L.latLngBounds(southWest, northEast);
//        
//        map.setMaxBounds(bounds);
        

        var tiles = L.tileLayer('https://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}',{
            maxZoom: 20,
            subdomains:['mt0','mt1','mt2','mt3']
        });
        

        map.addLayer(tiles);
        
         var onEachFeature = function(feature, layer) {
            layer.onmouseover
        
         }
         
        var zoneLayer = L.geoJson(zones, {
            
           style: function(feature) {
               return {
                   color: 'black',
                   weight: 2,
                   fillColor: getColor(feature.properties["ZONE_"]),
                   fillOpacity: 0.75
               }
           }, 
            onEachFeature: function(feature, layer){
                layer.on('mouseover', function(e){
                    layer.setStyle({
                        color: 'yellow'
                    })
                    layer.bringToFront();
                });
                layer.on('mouseout', function(e){
                    layer.setStyle({
                        color: 'black'
                    })
                })
            }
                     
        }).addTo(map);
        
        
        createPopup(zoneLayer);
    
        
        
        function createPopup(data){
            data.eachLayer(function(layer){
                
                var props = layer.feature.properties;

                var infoWindow = $('#hover-window');
                layer.on('mouseover', function(e){
                    var props = this.feature.properties;
                    
                    console.log("hello");
                    
                    infoWindow.show();
                    infoWindow.html("Zone: ");
                    
                    $(document).mousemove(function(e){
                        //first offset from the mouse position of the info window
                        infoWindow.css({"left": e.pageX + 6, "top": e.pageY - infoWindow.height() - 15}); 
                        
                        //if crashes into top, flip to lower right
                         if(infoWindow.offset().top < 4) {
                            infoWindow.css({"top": e.pageY + 15});
                        }
                        
                        //if crashes right, flip again
                        if(infoWindow.offset().left + infoWindow.width() >= $(document).width() - 40) {
                            infoWindow.css({"left": e.pageX - infoWindow.width() - 30});
                        }
                    })

                })
                
                layer.on('mouseout', function(e){
                    infoWindow.hide();
                })
                
            })
        }
        
//    
        function getColor (zone) {
        
            
                if(zone == "A-1") {
                    return '#8dd3c7';
                } else if(zone == "A-2") {
                    return '#1f78b4';
                } else if(zone == "B-1") {
                    return '#b2df8a';
                } else if(zone == "B-2") {
                    return '#33a02c'
                } else if(zone == "I-1") {
                    return '#fdbf6f'
                } else if(zone == "I-2") {
                    return '#ff7f00'
                } else if(zone == "R-1") {
                    return '#cab2d6'
                } else if (zone == "R-2"){
                    return '#6a3d9a'
                } else if (zone == "R-3"){
                    return '#fee08b'
                }
        }
//        
//       
//        function drawMap(data){ 
//    
//            
//            for (i = 0; i < 9; i++) {
//                
//                var content = "<b>"+("<h1>"+data.data[i].name+"</b><br></h1>")+ ("<p>"+data.data[i].city+", "+data.data[i].state+"</p><br>"+"<p2>"+data.data[i].quote+"<br></p2>") + "<figure><img src='1_"+data.data[i].photo+".jpg' width=150></figure>";
//                
////              to make hover:
//                
////                L.marker([data.data[i].lat,data.data[i].lng], {icon:icon}).bindPopup(content, {closeButton: false, keepInView: true}).on('mouseover',function(e){this.openPopup()}).on('mouseout', function(e){this.closePopup()}).addTo(map);
//
////              to make click:
//                
//                L.marker([data.data[i].lat,data.data[i].lng], {icon:icon}).bindPopup(content, {closeButton: false, keepInView: true}).addTo(map);
//                
//            }
//            
//        }           
    
        
          
    </script>
    
</body>

</html>